import{d as e,r as l,S as a,o as t,ae as o,b3 as r,e as s,h as i,B as d,l as u,w as n,g as p,W as m,X as c,V as f,f as y,C as v,p as h,D as _,j as b,aL as g,Q as k,R as V,aZ as w,ax as j,E as U}from"./index.CPcfy5fd.js";import{v as x}from"./el-loading.DUc5yYfm.js";import{E}from"./el-drawer.r4NjfdP6.js";import"./el-overlay.DftqKqsB.js";import{_ as N}from"./index.BU-uHgCU.js";import{E as C}from"./el-input.C_NraZld.js";import{E as T}from"./el-input-number.CCAs2zTn.js";import"./el-tooltip.l0sNRNKZ.js";import{E as A}from"./el-popper.oQ_1tnM-.js";import{b as O,a as L}from"./el-radio-group.2MAsiBq3.js";/* empty css                 *//* empty css               */import"./el-select.DlbtOjyU.js";import"./el-scrollbar.CGy9Vc8U.js";import"./el-tree.Bpu2x_8u.js";import"./el-checkbox.CxwJjOlx.js";import{E as M}from"./el-tree-select.BvQ0LvDh.js";import{E as I}from"./el-card.CoAyFuo3.js";import{E as P,a as B}from"./el-table-column.BrLwSw0l.js";import{_ as G}from"./index.BiDxP4gs.js";import{E as q,a as F}from"./el-form-item.lHJDIO-5.js";import{E as K}from"./el-button.DFafuuzN.js";import{E as R}from"./el-message-box.CIvl2Gml.js";import{E as S}from"./index.C0I96C1I.js";import"./index.B2Oee_uC.js";import"./index.BzmTEwIo.js";import"./vnode.WdqDFRAO.js";import"./event.CIKxL71l.js";import"./scroll.CE5T6uQg.js";import"./use-form-common-props.BseJruiQ.js";import"./el-popover.CijBp_Od.js";import"./dropdown.D3z6ZJ_U.js";import"./el-tab-pane.DP3qJZ_U.js";import"./strings.C3l49zS7.js";import"./index.AfNc8ccy.js";import"vue3_eman_server/js/plugin-vue_export-helper.BCo6x5W8.js";import"./index.BO5voRhJ.js";import"./index.CKqnEUPD.js";import"./index.BCOw_d-n.js";import"./index.CFbp2rmx.js";import"./token.DWNpOE8r.js";import"./castArray.C6a8QyiS.js";import"./isEqual.wucDy0nb.js";import"vue3_eman_server/js/Uint8Array.DxW3ztND.js";import"./debounce.erloDUjh.js";import"./_baseIteratee.VRSKdGvw.js";import"./index.YbX1I6v9.js";import"./index.C-5mtHV7.js";import"./validator.Dd25HNXD.js";var X=(e=>(e.CATALOG="CATALOG",e.MENU="MENU",e.BUTTON="BUTTON",e.EXTLINK="EXTLINK",e))(X||{});const z={class:"app-container"},D={class:"search-bar"},Q={class:"mb-10px"},W={class:"flex-y-center"},H={class:"flex-y-center"},J={class:"flex-y-center"},Y={class:"flex-y-center"},Z={key:0},$={key:1},ee={class:"flex-y-center"},le={class:"dialog-footer"},ae=e({name:"SysMenu",inheritAttrs:!1,__name:"index",setup(e){const ae=l(q),te=l(q),oe=l(!1),re=a({title:"新增菜单",visible:!1}),se=a({}),ie=l([]),de=l([]),ue=l({id:void 0,parentId:"0",visible:1,sort:1,type:X.MENU,alwaysShow:0,keepAlive:1,params:[]}),ne=l({...ue.value}),pe=a({parentId:[{required:!0,message:"请选择父级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],routeName:[{required:!0,message:"请输入路由名称",trigger:"blur"}],routePath:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],visible:[{required:!0,message:"请选择显示状态",trigger:"change"}]}),me=l();function ce(){oe.value=!0,w.getList(se).then((e=>{ie.value=e})).finally((()=>{oe.value=!1}))}function fe(){ae.value.resetFields(),ce()}function ye(e){me.value=e.id}function ve(e,l){w.getOptions(!0).then((e=>{de.value=[{value:"0",label:"顶级菜单",children:e}]})).then((()=>{re.visible=!0,l?(re.title="编辑菜单",w.getFormData(l).then((e=>{ue.value={...e},ne.value=e}))):(re.title="新增菜单",ne.value.parentId=null==e?void 0:e.toString())}))}function he(){ne.value.type!==ue.value.type&&ne.value.type===X.MENU&&(ue.value.type===X.CATALOG?ne.value.component="":(ne.value.routePath=ue.value.routePath,ne.value.component=ue.value.component))}function _e(){te.value.validate((e=>{if(e){const e=ne.value.id;if(e){if(ne.value.parentId==e)return void j.error("父级菜单不能为当前菜单");w.update(e,ne.value).then((()=>{j.success("修改成功"),be(),ce()}))}else w.add(ne.value).then((()=>{j.success("新增成功"),be(),ce()}))}}))}function be(){re.visible=!1,te.value.resetFields(),te.value.clearValidate(),ne.value={...ue.value}}return t((()=>{ce()})),(e,l)=>{const a=C,t=F,ue=K,me=q,ge=U,ke=G,Ve=P,we=S,je=B,Ue=I,xe=M,Ee=O,Ne=L,Ce=o("QuestionFilled"),Te=A,Ae=o("CirclePlusFilled"),Oe=o("DeleteFilled"),Le=T,Me=N,Ie=E,Pe=r("hasPerm"),Be=x;return s(),i("div",z,[d("div",D,[u(me,{ref_key:"queryFormRef",ref:ae,model:p(se),inline:!0},{default:n((()=>[u(t,{label:"关键字",prop:"keywords"},{default:n((()=>[u(a,{modelValue:p(se).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>p(se).keywords=e),placeholder:"菜单名称",clearable:"",onKeyup:m(ce,["enter"])},null,8,["modelValue"])])),_:1}),u(t,null,{default:n((()=>[u(ue,{type:"primary",icon:"search",onClick:ce},{default:n((()=>l[20]||(l[20]=[c("搜索")]))),_:1}),u(ue,{icon:"refresh",onClick:fe},{default:n((()=>l[21]||(l[21]=[c("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),u(Ue,{shadow:"never"},{default:n((()=>[d("div",Q,[f((s(),y(ue,{type:"success",icon:"plus",onClick:l[1]||(l[1]=e=>ve("0"))},{default:n((()=>l[22]||(l[22]=[c(" 新增 ")]))),_:1})),[[Pe,["sys:menu:add"]]])]),f((s(),y(je,{data:p(ie),"highlight-current-row":"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},onRowClick:ye},{default:n((()=>[u(Ve,{label:"菜单名称","min-width":"200"},{default:n((e=>[e.row.icon&&e.row.icon.startsWith("el-icon")?(s(),y(ge,{key:0,style:{"vertical-align":"-0.15em"}},{default:n((()=>[(s(),y(v(e.row.icon.replace("el-icon-",""))))])),_:2},1024)):e.row.icon?(s(),y(ke,{key:1,"icon-class":e.row.icon},null,8,["icon-class"])):h("",!0),c(" "+_(e.row.name),1)])),_:1}),u(Ve,{label:"类型",align:"center",width:"80"},{default:n((e=>[e.row.type===p(X).CATALOG?(s(),y(we,{key:0,type:"warning"},{default:n((()=>l[23]||(l[23]=[c("目录")]))),_:1})):h("",!0),e.row.type===p(X).MENU?(s(),y(we,{key:1,type:"success"},{default:n((()=>l[24]||(l[24]=[c("菜单")]))),_:1})):h("",!0),e.row.type===p(X).BUTTON?(s(),y(we,{key:2,type:"danger"},{default:n((()=>l[25]||(l[25]=[c("按钮")]))),_:1})):h("",!0),e.row.type===p(X).EXTLINK?(s(),y(we,{key:3,type:"info"},{default:n((()=>l[26]||(l[26]=[c("外链")]))),_:1})):h("",!0)])),_:1}),u(Ve,{label:"路由名称",align:"left",width:"150",prop:"routeName"}),u(Ve,{label:"路由路径",align:"left",width:"150",prop:"routePath"}),u(Ve,{label:"组件路径",align:"left",width:"250",prop:"component"}),u(Ve,{label:"权限标识",align:"center",width:"200",prop:"perm"}),u(Ve,{label:"状态",align:"center",width:"80"},{default:n((e=>[1===e.row.visible?(s(),y(we,{key:0,type:"success"},{default:n((()=>l[27]||(l[27]=[c("显示")]))),_:1})):(s(),y(we,{key:1,type:"info"},{default:n((()=>l[28]||(l[28]=[c("隐藏")]))),_:1}))])),_:1}),u(Ve,{label:"排序",align:"center",width:"80",prop:"sort"}),u(Ve,{fixed:"right",align:"center",label:"操作",width:"220"},{default:n((e=>["CATALOG"==e.row.type||"MENU"==e.row.type?f((s(),y(ue,{key:0,type:"primary",link:"",size:"small",icon:"plus",onClick:b((l=>ve(e.row.id)),["stop"])},{default:n((()=>l[29]||(l[29]=[c(" 新增 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:add"]]]):h("",!0),f((s(),y(ue,{type:"primary",link:"",size:"small",icon:"edit",onClick:b((l=>ve(void 0,e.row.id)),["stop"])},{default:n((()=>l[30]||(l[30]=[c(" 编辑 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:edit"]]]),f((s(),y(ue,{type:"danger",link:"",size:"small",icon:"delete",onClick:b((l=>function(e){if(!e)return j.warning("请勾选删除项"),!1;R.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{oe.value=!0,w.deleteById(e).then((()=>{j.success("删除成功"),ce()})).finally((()=>{oe.value=!1}))}),(()=>{j.info("已取消删除")}))}(e.row.id)),["stop"])},{default:n((()=>l[31]||(l[31]=[c(" 删除 ")]))),_:2},1032,["onClick"])),[[Pe,["sys:menu:delete"]]])])),_:1})])),_:1},8,["data"])),[[Be,p(oe)]])])),_:1}),u(Ie,{modelValue:p(re).visible,"onUpdate:modelValue":l[19]||(l[19]=e=>p(re).visible=e),title:p(re).title,size:"50%",onClose:be},{footer:n((()=>[d("div",le,[u(ue,{type:"primary",onClick:_e},{default:n((()=>l[56]||(l[56]=[c("确 定")]))),_:1}),u(ue,{onClick:be},{default:n((()=>l[57]||(l[57]=[c("取 消")]))),_:1})])])),default:n((()=>[u(me,{ref_key:"menuFormRef",ref:te,model:p(ne),rules:p(pe),"label-width":"100px"},{default:n((()=>[u(t,{label:"父级菜单",prop:"parentId"},{default:n((()=>[u(xe,{modelValue:p(ne).parentId,"onUpdate:modelValue":l[2]||(l[2]=e=>p(ne).parentId=e),placeholder:"选择上级菜单",data:p(de),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),u(t,{label:"菜单名称",prop:"name"},{default:n((()=>[u(a,{modelValue:p(ne).name,"onUpdate:modelValue":l[3]||(l[3]=e=>p(ne).name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),u(t,{label:"菜单类型",prop:"type"},{default:n((()=>[u(Ne,{modelValue:p(ne).type,"onUpdate:modelValue":l[4]||(l[4]=e=>p(ne).type=e),onChange:he},{default:n((()=>[u(Ee,{value:"CATALOG"},{default:n((()=>l[32]||(l[32]=[c("目录")]))),_:1}),u(Ee,{value:"MENU"},{default:n((()=>l[33]||(l[33]=[c("菜单")]))),_:1}),u(Ee,{value:"BUTTON"},{default:n((()=>l[34]||(l[34]=[c("按钮")]))),_:1}),u(Ee,{value:"EXTLINK"},{default:n((()=>l[35]||(l[35]=[c("外链")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),"EXTLINK"==p(ne).type?(s(),y(t,{key:0,label:"外链地址",prop:"path"},{default:n((()=>[u(a,{modelValue:p(ne).routePath,"onUpdate:modelValue":l[5]||(l[5]=e=>p(ne).routePath=e),placeholder:"请输入外链完整路径"},null,8,["modelValue"])])),_:1})):h("",!0),p(ne).type==p(X).MENU?(s(),y(t,{key:1,prop:"routeName"},{label:n((()=>[d("div",W,[l[37]||(l[37]=c(" 路由名称 ")),u(Te,{placement:"bottom",effect:"light"},{content:n((()=>l[36]||(l[36]=[c(" 如果需要开启缓存，需保证页面 defineOptions 中的 name 与此处一致，建议使用驼峰。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(a,{modelValue:p(ne).routeName,"onUpdate:modelValue":l[6]||(l[6]=e=>p(ne).routeName=e),placeholder:"User"},null,8,["modelValue"])])),_:1})):h("",!0),p(ne).type==p(X).CATALOG||p(ne).type==p(X).MENU?(s(),y(t,{key:2,prop:"routePath"},{label:n((()=>[d("div",H,[l[39]||(l[39]=c(" 路由路径 ")),u(Te,{placement:"bottom",effect:"light"},{content:n((()=>l[38]||(l[38]=[c(" 定义应用中不同页面对应的 URL 路径，目录需以 / 开头，菜单项不用。例如：系统管理目录 /system，系统管理下的用户管理菜单 user。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[p(ne).type==p(X).CATALOG?(s(),y(a,{key:0,modelValue:p(ne).routePath,"onUpdate:modelValue":l[7]||(l[7]=e=>p(ne).routePath=e),placeholder:"system"},null,8,["modelValue"])):(s(),y(a,{key:1,modelValue:p(ne).routePath,"onUpdate:modelValue":l[8]||(l[8]=e=>p(ne).routePath=e),placeholder:"user"},null,8,["modelValue"]))])),_:1})):h("",!0),p(ne).type==p(X).MENU?(s(),y(t,{key:3,prop:"component"},{label:n((()=>[d("div",J,[l[41]||(l[41]=c(" 组件路径 ")),u(Te,{placement:"bottom",effect:"light"},{content:n((()=>l[40]||(l[40]=[c(" 组件页面完整路径，相对于 src/views/，如 system/user/index，缺省后缀 .vue ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(a,{modelValue:p(ne).component,"onUpdate:modelValue":l[9]||(l[9]=e=>p(ne).component=e),placeholder:"system/user/index",style:{width:"95%"}},g({_:2},[p(ne).type==p(X).MENU?{name:"prepend",fn:n((()=>[l[42]||(l[42]=c("src/views/"))])),key:"0"}:void 0,p(ne).type==p(X).MENU?{name:"append",fn:n((()=>[l[43]||(l[43]=c(".vue"))])),key:"1"}:void 0]),1032,["modelValue"])])),_:1})):h("",!0),p(ne).type==p(X).MENU?(s(),y(t,{key:4},{label:n((()=>[d("div",Y,[l[45]||(l[45]=c(" 路由参数 ")),u(Te,{placement:"bottom",effect:"light"},{content:n((()=>l[44]||(l[44]=[c(" 组件页面使用 `useRoute().query.参数名` 获取路由参数值。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[p(ne).params&&0!==p(ne).params.length?(s(),i("div",$,[(s(!0),i(k,null,V(p(ne).params,((e,t)=>(s(),i("div",{key:t},[u(a,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,placeholder:"参数名",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),l[47]||(l[47]=d("span",{class:"mx-1"},"=",-1)),u(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:"参数值",style:{width:"100px"}},null,8,["modelValue","onUpdate:modelValue"]),p(ne).params.indexOf(e)===p(ne).params.length-1?(s(),y(ge,{key:0,class:"ml-2 cursor-pointer color-[var(--el-color-success)]",style:{"vertical-align":"-0.15em"},onClick:l[11]||(l[11]=e=>p(ne).params.push({key:"",value:""}))},{default:n((()=>[u(Ae)])),_:1})):h("",!0),u(ge,{class:"ml-2 cursor-pointer color-[var(--el-color-danger)]",style:{"vertical-align":"-0.15em"},onClick:l=>p(ne).params.splice(p(ne).params.indexOf(e),1)},{default:n((()=>[u(Oe)])),_:2},1032,["onClick"])])))),128))])):(s(),i("div",Z,[u(ue,{type:"success",plain:"",onClick:l[10]||(l[10]=e=>p(ne).params=[{key:"",value:""}])},{default:n((()=>l[46]||(l[46]=[c(" 添加路由参数 ")]))),_:1})]))])),_:1})):h("",!0),p(ne).type!==p(X).BUTTON?(s(),y(t,{key:5,prop:"visible",label:"显示状态"},{default:n((()=>[u(Ne,{modelValue:p(ne).visible,"onUpdate:modelValue":l[12]||(l[12]=e=>p(ne).visible=e)},{default:n((()=>[u(Ee,{value:1},{default:n((()=>l[48]||(l[48]=[c("显示")]))),_:1}),u(Ee,{value:0},{default:n((()=>l[49]||(l[49]=[c("隐藏")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):h("",!0),p(ne).type===p(X).CATALOG||p(ne).type===p(X).MENU?(s(),y(t,{key:6},{label:n((()=>[d("div",ee,[l[51]||(l[51]=c(" 始终显示 ")),u(Te,{placement:"bottom",effect:"light"},{content:n((()=>l[50]||(l[50]=[c(" 选择“是”，即使目录或菜单下只有一个子节点，也会显示父节点。 "),d("br",null,null,-1),c(" 选择“否”，如果目录或菜单下只有一个子节点，则只显示该子节点，隐藏父节点。 "),d("br",null,null,-1),c(" 如果是叶子节点，请选择“否”。 ")]))),default:n((()=>[u(ge,{class:"ml-1 cursor-pointer"},{default:n((()=>[u(Ce)])),_:1})])),_:1})])])),default:n((()=>[u(Ne,{modelValue:p(ne).alwaysShow,"onUpdate:modelValue":l[13]||(l[13]=e=>p(ne).alwaysShow=e)},{default:n((()=>[u(Ee,{value:1},{default:n((()=>l[52]||(l[52]=[c("是")]))),_:1}),u(Ee,{value:0},{default:n((()=>l[53]||(l[53]=[c("否")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):h("",!0),p(ne).type===p(X).MENU?(s(),y(t,{key:7,label:"缓存页面"},{default:n((()=>[u(Ne,{modelValue:p(ne).keepAlive,"onUpdate:modelValue":l[14]||(l[14]=e=>p(ne).keepAlive=e)},{default:n((()=>[u(Ee,{value:1},{default:n((()=>l[54]||(l[54]=[c("开启")]))),_:1}),u(Ee,{value:0},{default:n((()=>l[55]||(l[55]=[c("关闭")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):h("",!0),u(t,{label:"排序",prop:"sort"},{default:n((()=>[u(Le,{modelValue:p(ne).sort,"onUpdate:modelValue":l[15]||(l[15]=e=>p(ne).sort=e),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])])),_:1}),p(ne).type==p(X).BUTTON?(s(),y(t,{key:8,label:"权限标识",prop:"perm"},{default:n((()=>[u(a,{modelValue:p(ne).perm,"onUpdate:modelValue":l[16]||(l[16]=e=>p(ne).perm=e),placeholder:"sys:user:add"},null,8,["modelValue"])])),_:1})):h("",!0),p(ne).type!==p(X).BUTTON?(s(),y(t,{key:9,label:"图标",prop:"icon"},{default:n((()=>[u(Me,{modelValue:p(ne).icon,"onUpdate:modelValue":l[17]||(l[17]=e=>p(ne).icon=e)},null,8,["modelValue"])])),_:1})):h("",!0),p(ne).type==p(X).CATALOG?(s(),y(t,{key:10,label:"跳转路由"},{default:n((()=>[u(a,{modelValue:p(ne).redirect,"onUpdate:modelValue":l[18]||(l[18]=e=>p(ne).redirect=e),placeholder:"跳转路由"},null,8,["modelValue"])])),_:1})):h("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{ae as default};
