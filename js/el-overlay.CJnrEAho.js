import{by as e,t as o,z as t,d as n,b as l,l as a,k as s,a6 as u,v as c,o as d,P as r,a5 as i,J as m,bz as p,aj as f,c as v,H as y,a3 as b,I as g,bA as C,a1 as h,bB as x,a2 as M,bk as k,r as B,bC as w,U as E,F as S,bD as I,a7 as L}from"./index.CTNNcVLm.js";import{P as O}from"./vnode.D-pIvZEJ.js";import{U as z,t as D}from"./event.CIKxL71l.js";import{a as A}from"./scroll.BZpBMdC7.js";import{d as F}from"./use-form-common-props.e2EEXdnc.js";import{i as Y}from"./index.BZZYWKrW.js";const j=o=>{if(!o)return{onClick:e,onMousedown:e,onMouseup:e};let t=!1,n=!1;return{onClick:e=>{t&&n&&o(e),t=n=!1},onMousedown:e=>{t=e.target===e.currentTarget},onMouseup:e=>{n=e.target===e.currentTarget}}},P=o({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:t([String,Array,Object])},zIndex:{type:t([String,Number])}});const T=n({name:"ElOverlay",props:P,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const n=l("overlay"),{onClick:c,onMousedown:d,onMouseup:r}=j(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?a("div",{class:[n.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:c,onMousedown:d,onMouseup:r},[s(o,"default")],O.STYLE|O.CLASS|O.PROPS,["onClick","onMouseup","onMousedown"]):u("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[s(o,"default")])}}),X=o({center:Boolean,alignCenter:Boolean,closeIcon:{type:c},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),$={close:()=>!0},N=(e,o,t,n)=>{let l={offsetX:0,offsetY:0};const a=o=>{const t=o.clientX,a=o.clientY,{offsetX:s,offsetY:u}=l,c=e.value.getBoundingClientRect(),d=c.left,r=c.top,i=c.width,p=c.height,f=document.documentElement.clientWidth,v=document.documentElement.clientHeight,y=-d+s,b=-r+u,g=f-d-i+s,C=v-r-p+u,h=o=>{let c=s+o.clientX-t,d=u+o.clientY-a;(null==n?void 0:n.value)||(c=Math.min(Math.max(c,y),g),d=Math.min(Math.max(d,b),C)),l={offsetX:c,offsetY:d},e.value&&(e.value.style.transform=`translate(${m(c)}, ${m(d)})`)},x=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",x)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",x)},s=()=>{o.value&&e.value&&o.value.removeEventListener("mousedown",a)};return d((()=>{r((()=>{t.value?o.value&&e.value&&o.value.addEventListener("mousedown",a):s()}))})),i((()=>{s()})),{resetPosition:()=>{l={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")}}},H=o({...X,appendToBody:Boolean,appendTo:{type:t([String,Object]),default:"body"},beforeClose:{type:t(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),R={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[z]:e=>p(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},V=(e,o={})=>{f(e)||D("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||l("popup"),n=v((()=>t.bm("parent","hidden")));if(!y||b(document.body,n.value))return;let a=0,s=!1,u="0";const c=()=>{setTimeout((()=>{"undefined"!=typeof document&&(M(null==document?void 0:document.body,n.value),s&&document&&(document.body.style.width=u))}),200)};g(e,(e=>{if(!e)return void c();s=!b(document.body,n.value),s&&(u=document.body.style.width),a=A(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,l=C(document.body,"overflowY");a>0&&(o||"scroll"===l)&&s&&(document.body.style.width=`calc(100% - ${a}px)`),h(document.body,n.value)})),x((()=>c()))},U=(e,o)=>{var t;const n=S().emit,{nextZIndex:l}=k();let a="";const s=F(),u=F(),c=B(!1),r=B(!1),i=B(!1),p=B(null!=(t=e.zIndex)?t:l());let f,b;const C=w("namespace",I),h=v((()=>{const o={},t=`--${C.value}-dialog`;return e.fullscreen||(e.top&&(o[`${t}-margin-top`]=e.top),e.width&&(o[`${t}-width`]=m(e.width))),o})),x=v((()=>e.alignCenter?{display:"flex"}:{}));function M(){null==b||b(),null==f||f(),e.openDelay&&e.openDelay>0?({stop:f}=L((()=>A()),e.openDelay)):A()}function O(){null==f||f(),null==b||b(),e.closeDelay&&e.closeDelay>0?({stop:b}=L((()=>j()),e.closeDelay)):j()}function D(){e.beforeClose?e.beforeClose((function(e){e||(r.value=!0,c.value=!1)})):O()}function A(){y&&(c.value=!0)}function j(){c.value=!1}return e.lockScroll&&V(c),g((()=>e.modelValue),(t=>{t?(r.value=!1,M(),i.value=!0,p.value=Y(e.zIndex)?l():p.value++,E((()=>{n("open"),o.value&&(o.value.scrollTop=0)}))):c.value&&O()})),g((()=>e.fullscreen),(e=>{o.value&&(e?(a=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=a)})),d((()=>{e.modelValue&&(c.value=!0,i.value=!0,M())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(z,!1),e.destroyOnClose&&(i.value=!1)},beforeLeave:function(){n("close")},handleClose:D,onModalClick:function(){e.closeOnClickModal&&D()},close:O,doClose:j,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&D()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:s,bodyId:u,closed:r,style:h,overlayDialogStyle:x,rendered:i,visible:c,zIndex:p}};export{T as E,R as a,N as b,V as c,H as d,j as e,X as f,$ as g,U as u};
