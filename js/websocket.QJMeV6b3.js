import{d as e,bu as a,r as s,o as t,e as l,h as n,l as o,w as u,X as r,g as d,aj as i,f as p,B as c,Q as m,R as f,i as v,D as b,bv as _,bc as y}from"./index.7tU0nMs0.js";import{a as g,E as h}from"./el-form-item.DCZwHVfA.js";import{E as j}from"./el-card.D-HX47Fo.js";import{a as k,E as x}from"./el-col.BxL_kbOq.js";/* empty css               */import{E as V}from"./el-button.DDIyjSzN.js";import{E as w}from"./el-input.CDw3Qd3x.js";import{E}from"./el-link.puWkxxoT.js";import{E as I}from"./index.BQgtJMmf.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./use-form-common-props.BgQB0-E3.js";import"./castArray.DosOevA7.js";import"./event.CIKxL71l.js";import"./_Uint8Array.BssvCTDp.js";import"./index.CGFuthEO.js";import"./index.CwfqjSEI.js";import"./index.D-8SIWcM.js";import"./index.6lb3H4MZ.js";const S={class:"app-container"},C={class:"message-container"},A={key:0,class:"message-content"},R={class:"color-#333"},W={key:1},B=U(e({__name:"websocket",setup(e){const U=a(),B=s(!1),D=s("wss://api.youlai.tech/ws"),J=s("root"),L=s([]),N=s("亲爱的大冤种们，由于一只史诗级的BUG，系统版本已经被迫回退到了0.0.1。"),O=s("hi , "+J.value+" , 我是"+U.userInfo.username+" , 想和你交个朋友 ! ");let Q;function q(){Q=new _({brokerURL:D.value,connectHeaders:{Authorization:y()},debug:e=>{},onConnect:()=>{B.value=!0,L.value.push({sender:"Server",content:"Websocket 已连接",type:"tip"}),Q.subscribe("/topic/notice",(e=>{L.value.push({sender:"Server",content:e.body})})),Q.subscribe("/user/queue/greeting",(e=>{const a=JSON.parse(e.body);L.value.push({sender:a.sender,content:a.content})}))},onStompError:e=>{},onDisconnect:()=>{B.value=!1,L.value.push({sender:"Server",content:"Websocket 已断开",type:"tip"})}}),Q.activate()}function z(){Q&&Q.connected&&(Q.deactivate(),B.value=!1,L.value.push({sender:"Server",content:"Websocket 已断开",type:"tip"}))}function G(){Q.connected&&(Q.publish({destination:"/topic/notice",body:N.value}),L.value.push({sender:U.userInfo.username,content:N.value}))}function H(){Q.connected&&(Q.publish({destination:"/app/sendToUser/"+J.value,body:O.value}),L.value.push({sender:U.userInfo.username,content:O.value}))}return t((()=>{q()})),(e,a)=>{const s=E,t=w,_=V,y=k,Q=I,K=x,T=j,X=g,F=h;return l(),n("div",S,[o(s,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/websocket.vue",type:"primary",target:"_blank",class:"mb-[20px]"},{default:u((()=>a[4]||(a[4]=[r(" 示例源码 请点击>>>> ")]))),_:1}),o(K,{gutter:10},{default:u((()=>[o(y,{span:12},{default:u((()=>[o(T,null,{default:u((()=>[o(K,null,{default:u((()=>[o(y,{span:16},{default:u((()=>[o(t,{modelValue:d(D),"onUpdate:modelValue":a[0]||(a[0]=e=>i(D)?D.value=e:null),class:"w-220px"},null,8,["modelValue"]),o(_,{type:"primary",class:"ml-5",disabled:d(B),onClick:q},{default:u((()=>a[5]||(a[5]=[r(" 连接 ")]))),_:1},8,["disabled"]),o(_,{type:"danger",disabled:!d(B),onClick:z},{default:u((()=>a[6]||(a[6]=[r(" 断开 ")]))),_:1},8,["disabled"])])),_:1}),o(y,{span:8,class:"text-right"},{default:u((()=>[a[9]||(a[9]=r(" 连接状态： ")),d(B)?(l(),p(Q,{key:0,class:"ml-2",type:"success"},{default:u((()=>a[7]||(a[7]=[r("已连接")]))),_:1})):(l(),p(Q,{key:1,class:"ml-2",type:"info"},{default:u((()=>a[8]||(a[8]=[r("已断开")]))),_:1}))])),_:1})])),_:1})])),_:1}),o(T,{class:"mt-5"},{default:u((()=>[o(F,{"label-width":"90px"},{default:u((()=>[o(X,{label:"消息内容"},{default:u((()=>[o(t,{modelValue:d(N),"onUpdate:modelValue":a[1]||(a[1]=e=>i(N)?N.value=e:null),type:"textarea"},null,8,["modelValue"])])),_:1}),o(X,null,{default:u((()=>[o(_,{type:"primary",onClick:G},{default:u((()=>a[10]||(a[10]=[r("发送广播")]))),_:1})])),_:1})])),_:1})])),_:1}),o(T,{class:"mt-5"},{default:u((()=>[o(F,{"label-width":"90px"},{default:u((()=>[o(X,{label:"消息内容"},{default:u((()=>[o(t,{modelValue:d(O),"onUpdate:modelValue":a[2]||(a[2]=e=>i(O)?O.value=e:null),type:"textarea"},null,8,["modelValue"])])),_:1}),o(X,{label:"消息接收人"},{default:u((()=>[o(t,{modelValue:d(J),"onUpdate:modelValue":a[3]||(a[3]=e=>i(J)?J.value=e:null)},null,8,["modelValue"])])),_:1}),o(X,null,{default:u((()=>[o(_,{type:"primary",onClick:H},{default:u((()=>a[11]||(a[11]=[r("发送点对点消息")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),o(y,{span:12},{default:u((()=>[o(T,null,{default:u((()=>[c("div",C,[(l(!0),n(m,null,f(d(L),((e,a)=>(l(),n("div",{key:a,class:v({"tip-message":"tip"===e.type,message:"tip"!==e.type,"message--sent":e.sender===d(U).userInfo.username,"message--received":e.sender!==d(U).userInfo.username})},["tip"!=e.type?(l(),n("div",A,[c("div",{class:v({"message-sender":e.sender===d(U).userInfo.username,"message-receiver":e.sender!==d(U).userInfo.username})},b(e.sender),3),c("div",R,b(e.content),1)])):(l(),n("div",W,b(e.content),1))],2)))),128))])])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-f93a47ed"]]);export{B as default};
